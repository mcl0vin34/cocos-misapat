{"version":3,"sources":["file:///C:/GitHub/cocos-misapat/assets/scripts/GenerateLink.ts"],"names":["_decorator","Component","Node","SocketManager","ccclass","property","GenerateLink","onLoad","node","on","EventType","TOUCH_END","onGenerateLinkClick","userId","instance","getUserId","console","error","fullUrl","baseUrl","tg","window","Telegram","WebApp","openTelegramLink","open"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;;AACvBC,MAAAA,a,iBAAAA,a;;;;;;;;;AAAwC;OAC3C;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;8BAGjBM,Y,WADZF,OAAO,CAAC,cAAD,C,2BAAR,MACaE,YADb,SACkCL,SADlC,CAC4C;AAAA;AAAA;;AAAA;AAAA;;AAI1CM,QAAAA,MAAM,GAAG;AACP;AACA,eAAKC,IAAL,CAAUC,EAAV,CAAaP,IAAI,CAACQ,SAAL,CAAeC,SAA5B,EAAuC,KAAKC,mBAA5C,EAAiE,IAAjE;AACD;;AAEDA,QAAAA,mBAAmB,GAAG;AAAA;;AACpB,cAAMC,MAAM,GAAG;AAAA;AAAA,8CAAcC,QAAd,CAAuBC,SAAvB,EAAf;;AACA,cAAI,CAACF,MAAL,EAAa;AACXG,YAAAA,OAAO,CAACC,KAAR,CAAc,wBAAd;AACA;AACD;;AACD,cAAMC,OAAO,QAAM,KAAKC,OAAX,GAAqBN,MAAlC,CANoB,CAQpB;;AACA,cAAMO,EAAE,gBAAIC,MAAD,CAAgBC,QAAnB,qBAAG,UAA0BC,MAArC;;AACA,cAAIH,EAAE,IAAIA,EAAE,CAACI,gBAAb,EAA+B;AAC7BJ,YAAAA,EAAE,CAACI,gBAAH,CAAoBN,OAApB;AACD,WAFD,MAEO;AACL;AACAG,YAAAA,MAAM,CAACI,IAAP,CAAYP,OAAZ,EAAqB,QAArB;AACD;AACF;;AAzByC,O,0EACzCb,Q;;;;;iBACiB,8C","sourcesContent":["import { _decorator, Component, Node } from \"cc\";\r\nimport { SocketManager } from \"./SocketManager\"; // Убедись, что путь корректный\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"GenerateLink\")\r\nexport class GenerateLink extends Component {\r\n  @property\r\n  baseUrl: string = \"https://t.me/misapatStage_bot?startapp=refId\";\r\n\r\n  onLoad() {\r\n    // Добавляем обработчик события нажатия на узел\r\n    this.node.on(Node.EventType.TOUCH_END, this.onGenerateLinkClick, this);\r\n  }\r\n\r\n  onGenerateLinkClick() {\r\n    const userId = SocketManager.instance.getUserId();\r\n    if (!userId) {\r\n      console.error(\"User ID не установлен.\");\r\n      return;\r\n    }\r\n    const fullUrl = `${this.baseUrl}${userId}`;\r\n\r\n    // Проверяем, доступен ли объект Telegram WebApp\r\n    const tg = (window as any).Telegram?.WebApp;\r\n    if (tg && tg.openTelegramLink) {\r\n      tg.openTelegramLink(fullUrl);\r\n    } else {\r\n      // Если не в Telegram WebApp, открываем ссылку в новом окне\r\n      window.open(fullUrl, \"_blank\");\r\n    }\r\n  }\r\n}\r\n"]}